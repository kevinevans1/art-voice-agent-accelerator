# ═══════════════════════════════════════════════════════════════════════════════
# Auth Agent - Unified Schema
# ═══════════════════════════════════════════════════════════════════════════════
# Authentication and identity verification specialist
# Works with both SpeechCascade and VoiceLive orchestrators
#
# Note: When used with the 'banking' scenario, this agent gets the
# generate_personalized_greeting tool added for high-touch experience.
# ═══════════════════════════════════════════════════════════════════════════════

name: AuthAgent
description: Handles MFA, identity verification, and security questions

greeting: |
  {% if institution_name %}Hello, thank you for calling {{ institution_name }}. How can I help you today?
  {% else %}Hello, thank you for calling. How can I help you today?
  {% endif %}
return_greeting: "Welcome back. Let me verify a few details and we'll continue."

# ─────────────────────────────────────────────────────────────────────────────
# Handoff Configuration
# ─────────────────────────────────────────────────────────────────────────────
handoff:
  trigger: handoff_to_auth            # Other agents call this to reach AuthAgent


# ─────────────────────────────────────────────────────────────────────────────
# Voice Configuration
# ─────────────────────────────────────────────────────────────────────────────
voice:
  name: en-US-Ava:DragonHDLatestNeural
  type: azure-standard
  rate: "0%"

# ─────────────────────────────────────────────────────────────────────────────
# Model Configuration (LLM for agent reasoning)
# ─────────────────────────────────────────────────────────────────────────────
voicelive_model:
  deployment_id: gpt-realtime
  temperature: 0.6                        # Lower for consistent authentication
  max_tokens: 150

cascade_model:
  deployment_id: gpt-4o
  temperature: 0.6
  max_tokens: 100

# ─────────────────────────────────────────────────────────────────────────────
# Session Configuration (VoiceLive-specific)
# ─────────────────────────────────────────────────────────────────────────────
session:
  modalities: [TEXT, AUDIO]
  input_audio_format: PCM16
  output_audio_format: PCM16

  input_audio_transcription_settings:
    model: azure-speech
    language: en-US

  turn_detection:
    type: azure_semantic_vad
    threshold: 0.5
    prefix_padding_ms: 240
    silence_duration_ms: 700

  tool_choice: auto

# ─────────────────────────────────────────────────────────────────────────────
# Speech Configuration (Cascade Mode Only)
# ─────────────────────────────────────────────────────────────────────────────
speech:
  recognition:
    language: en-US

  synthesis:
    voice_name: en-US-ShimmerTurboMultilingualNeural

  vad:
    threshold: 0.02
    silence_duration_ms: 700
    prefix_padding_ms: 200

# ─────────────────────────────────────────────────────────────────────────────
# Tools (referenced by name from shared registry)
# ─────────────────────────────────────────────────────────────────────────────
tools:
  # MFA & Identity Verification (Customer)
  - verify_client_identity
  - send_mfa_code
  - verify_mfa_code
  - resend_mfa_code
  
  # B2B Verification (Claimant Carriers)
  - verify_cc_caller               # Verify Claimant Carrier rep for subrogation
  
  # Handoffs - Banking Scenario
  - handoff_concierge              # Return to BankingConcierge
  - handoff_fraud_agent            # Transfer to fraud if suspicious
  
  # Handoffs - Insurance Scenario (Customer)
  - handoff_policy_advisor         # Transfer to PolicyAdvisor (insurance)
  - handoff_fnol_agent             # Transfer to FNOLAgent (insurance claims)
  
  # Handoffs - Insurance Scenario (B2B)
  - handoff_subro_agent            # Transfer to SubroAgent (subrogation/CC inquiries)
  
  # Escalation
  - escalate_human
  - escalate_emergency             # For medical/injury/fire emergencies

template_vars:
  institution_name: "{{ institution_name | default('XYMZ Insurance') }}"
  agent_name: "AuthAgent"
  industry: "{{ industry | default('insurance') }}"

# ─────────────────────────────────────────────────────────────────────────────
# Prompt (inline for simple agent)
# ─────────────────────────────────────────────────────────────────────────────
prompts:
  path: prompt.jinja